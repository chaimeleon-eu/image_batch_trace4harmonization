# Trace4Harmonization-Docker

## Description

Harmonize numerical values extracted from medical images (e.g. acquired with different models of image-acquisition system)

## Usage
For the calibration stage run:

```
jobman submit -- "udocker load -i ~/persistent-home/trace4harmonization-docker.tar.gz trace4harmonization && udcoker run --user=root -t --rm -v /home/chaimeleon/persistent-home:/app/files --env OPERATION=calibrate --env TRAINING_CALIBRATION_FILENAME=<csv_filename_for_calibration_inside_persistend_mount.csv>  trace4harmonization:latest python3 /app/startup.py"
```

For the application stage run:

```
jobman submit -- "udocker load -i ~/persistent-home/trace4harmonization-docker.tar.gz trace4harmonization && udcoker run --user=root -t --rm -v /home/chaimeleon/persistent-home:/app/files --env OPERATION=apply --env TRAINING_CALIBRATION_FILENAME=<csv_filename_for_application_inside_persistend_mount.csv>  trace4harmonization:latest python3 /app/startup.py"
```

## Dev info

For building the image put the content of the folder 'for_redistribution_files_only' (you can find it in release attched files) generated by MATLAB inside the app/scripts folder. Then:

```
docker build -t trace4harmonization .
```

To save it:
```
docker run -ti --rm -v </local/path/to/repo/Docker/app/files>:/app/files --env-file ./envfile  --env-file <path/to/aws/credentials>  trace4harmonization python3 /app/startup.py
```

Then upload to the chAImeleon platform as follows:

- After Log-in select "app dashboard" from the menu in the top-right corner
- In the new dashboard opened launch a desktop environment
- Load the compressed docker image by drag and drop pr through the guacamole interface
- Test the application as described in Usage


## LICENSE

The code in the repository is distributed under the AGPL-v3.0 license attached. PLEASE NOTICE that the license refers ONLY TO THE CODE publicly visible here in the repository AND NOT IN ANY WAY to the attached asset files in the release section, that are not generated from code packaging. In particular, the software `Trace4Harmonization.exe`, for which you can find more details here: https://openebench.bsc.es/tool/trace4harmonization, is distributed only with a commercial license and YOU SHOULD CONTACT DeepTrace Technologies s.r.l. for its usage and redistribution.
